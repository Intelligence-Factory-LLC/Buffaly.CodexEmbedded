<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Codex Recap Export</title>
	<link rel="icon" type="image/x-icon" href="images/favicon.ico">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
	<link rel="stylesheet" href="site.css?v=20260226-imagepreview1">
	<style>
		.recap-panel {
			overflow: auto;
		}

		.recap-shell {
			padding: 0.55rem 0.6rem 0.8rem;
		}

		.recap-explain {
			border: 1px solid #e2e8f0;
			border-radius: 8px;
			padding: 0.8rem 0.9rem;
			background: #f8fafc;
			margin-bottom: 1rem;
		}

		.recap-export-grid {
			display: grid;
			grid-template-columns: repeat(2, minmax(0, 1fr));
			gap: 0.65rem;
			margin-bottom: 1rem;
		}

		.recap-export-card {
			border: 1px solid #e2e8f0;
			border-radius: 8px;
			padding: 0.6rem;
			background: #ffffff;
		}

		.recap-export-card h3 {
			margin: 0 0 0.5rem 0;
			font-size: 0.86rem;
			font-weight: 700;
			color: #0f172a;
		}

		.recap-field-row {
			display: grid;
			grid-template-columns: 110px minmax(0, 1fr);
			align-items: center;
			gap: 0.5rem;
			margin-bottom: 0.4rem;
		}

		.recap-field-row label,
		.recap-project-header label {
			font-size: 0.78rem;
			font-weight: 700;
			color: #334155;
		}

		.recap-field-row input[type="date"],
		.recap-field-row select {
			width: 100%;
			min-height: 2rem;
			border: 1px solid #cbd5e1;
			border-radius: 6px;
			padding: 0.24rem 0.42rem;
			background: #ffffff;
			color: #0f172a;
			font-size: 0.84rem;
		}

		.recap-project-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 0.45rem;
			margin-bottom: 0.45rem;
		}

		.recap-project-header-right {
			display: inline-flex;
			align-items: center;
			gap: 0.45rem;
		}

		.recap-project-header button,
		#recapGenerateBtn {
			min-height: 2rem;
			padding: 0.26rem 0.52rem;
			border: 1px solid #cbd5e1;
			border-radius: 6px;
			background: #ffffff;
			color: #1e293b;
			cursor: pointer;
			font-size: 0.84rem;
		}

		.recap-project-header button:hover,
		#recapGenerateBtn:hover {
			background: #eff6ff;
			border-color: #93c5fd;
		}

		.recap-project-list {
			width: 100%;
			min-height: 14rem;
			max-height: 18rem;
			border: 1px solid #e2e8f0;
			border-radius: 8px;
		}

		.recap-project-option {
			display: flex;
			align-items: flex-start;
			gap: 0.5rem;
		}

		.recap-project-option input[type="checkbox"] {
			margin-top: 0.15rem;
		}

		.recap-project-option-body {
			min-width: 0;
			flex: 1;
		}

		.recap-project-option-disabled {
			opacity: 0.56;
		}

		.recap-actions {
			display: flex;
			flex-wrap: wrap;
			align-items: center;
			gap: 0.6rem;
			margin-bottom: 0.55rem;
		}

		.recap-run-state {
			display: inline-flex;
			align-items: center;
			gap: 0.35rem;
			padding: 0.32rem 0.58rem;
			border-radius: 999px;
			font-size: 0.8rem;
			border: 1px solid rgba(30, 58, 91, 0.18);
			background: rgba(255, 255, 255, 0.9);
			color: #334155;
		}

		.recap-run-state.ready {
			background: rgba(15, 158, 81, 0.14);
			color: #0f9e51;
		}

		.recap-run-state.busy {
			background: rgba(52, 123, 246, 0.14);
			color: #1f5fbf;
		}

		.recap-run-state.idle {
			background: rgba(148, 163, 184, 0.16);
			color: #475569;
		}

		.recap-spin {
			animation: recap-spin 0.9s linear infinite;
		}

		@keyframes recap-spin {
			from { transform: rotate(0deg); }
			to { transform: rotate(360deg); }
		}

		.recap-preview-wrap {
			margin-top: 0.65rem;
		}

		.recap-preview-wrap h3 {
			margin: 0 0 0.35rem 0;
			font-size: 0.86rem;
			color: #0f172a;
		}

		#recapPreview {
			min-height: 24rem;
			max-height: 60vh;
			overflow: auto;
			white-space: pre-wrap;
			border-radius: 8px;
			border: 1px solid #dbe5f1;
			background: #f8fafc;
			padding: 0.6rem;
			margin-bottom: 0;
		}

		@media (max-width: 1000px) {
			.recap-export-grid {
				grid-template-columns: 1fr;
			}

			.recap-field-row {
				grid-template-columns: 1fr;
				gap: 0.22rem;
				margin-bottom: 0.48rem;
			}

			.recap-project-header {
				flex-wrap: wrap;
			}
		}

		@media (max-width: 900px) {
			.recap-panel {
				height: calc(100dvh - 0.7rem);
				overflow: auto;
			}

			.recap-shell {
				padding: 0.45rem;
				padding-bottom: 1.5rem;
			}

			.recap-project-list {
				max-height: 36vh;
			}

			#recapPreview {
				min-height: 50vh;
				max-height: none;
			}
		}
	</style>
</head>
<body>
	<div class="layout">
		<button id="mobileProjectsBtn" class="toolbar-mobile-projects-btn" type="button" title="Show navigation" aria-label="Show navigation" aria-expanded="false">
			<i class="bi bi-layout-sidebar-inset-reverse" aria-hidden="true"></i>
			<span>Menu</span>
		</button>
		<main class="main codex-main">
			<aside id="sessionSidebar" class="panel session-sidebar">
				<div class="sidebar-shell-header">
					<a class="sidebar-logo-btn" href="https://buffa.ly/?utm_source=codexembedded&utm_medium=recap_logo&utm_campaign=sidebar" target="_blank" rel="noopener" title="Made by the Buffaly team - learn more" aria-label="Made by the Buffaly team - learn more">
						<img class="sidebar-logo-image" src="images/bf_logo_fav_Large.png" alt="">
					</a>
					<button id="sidebarToggleBtn" type="button" class="sidebar-collapse-btn sidebar-shell-toggle-btn" title="Hide navigation" aria-label="Hide navigation">
						<i class="bi bi-layout-sidebar-inset-reverse" aria-hidden="true"></i>
					</button>
				</div>
				<nav class="sidebar-nav" aria-label="Main navigation">
					<a class="sidebar-nav-link" href="./">
						<i class="bi bi-chat-square-text" aria-hidden="true"></i>
						<span>Codex</span>
					</a>
					<a class="sidebar-nav-link" href="logs">
						<i class="bi bi-journal-text" aria-hidden="true"></i>
						<span>Logs</span>
					</a>
					<a class="sidebar-nav-link" href="watcher">
						<i class="bi bi-eye" aria-hidden="true"></i>
						<span>Watcher</span>
					</a>
					<a class="sidebar-nav-link active" href="recap" aria-current="page">
						<i class="bi bi-clock-history" aria-hidden="true"></i>
						<span>Recap</span>
					</a>
					<a class="sidebar-nav-link" href="server">
						<i class="bi bi-cpu" aria-hidden="true"></i>
						<span>Server</span>
					</a>
					<a class="sidebar-nav-link" href="settings">
						<i class="bi bi-sliders" aria-hidden="true"></i>
						<span>Settings</span>
					</a>
				</nav>
				<div class="sidebar-divider" aria-hidden="true"></div>
				<div class="recap-sidebar-note">
					Generate markdown exports directly from Codex session files for a specific time window.
				</div>
				<div class="sidebar-divider sidebar-project-divider" aria-hidden="true"></div>
				<div class="sidebar-create-row">
					<button id="recapRefreshReportsBtn" class="new-project-btn" type="button">
						<i class="bi bi-arrow-clockwise" aria-hidden="true"></i>
						<span>Refresh Reports</span>
					</button>
				</div>
				<div class="sidebar-divider sidebar-project-divider" aria-hidden="true"></div>
				<div id="recapReportsList" class="project-list"></div>
			</aside>
			<section class="panel chat-panel recap-panel">
				<div class="panel-title">Recap Export</div>
				<div class="recap-shell">
					<div class="recap-explain">
						<strong>What this page does</strong><br>
						Build a markdown recap from Codex session history. Choose a time window, include all projects or a subset, pick message-only or full detail, then generate and download the report.
					</div>

					<div class="recap-export-grid">
						<div class="recap-export-card">
							<h3>Time Window</h3>
							<div class="recap-field-row">
								<label for="recapStartDate">Start date</label>
								<input id="recapStartDate" type="date">
							</div>
							<div class="recap-field-row">
								<label for="recapEndDate">End date</label>
								<input id="recapEndDate" type="date">
							</div>
							<div class="recap-field-row">
								<label for="recapDetailLevel">Detail level</label>
								<select id="recapDetailLevel">
									<option value="messages">User and assistant messages only</option>
									<option value="all">Everything (including tool calls and results)</option>
								</select>
							</div>
						</div>

						<div class="recap-export-card">
							<h3>Project Scope</h3>
							<div class="recap-project-header">
								<label for="recapProjectList">Projects</label>
								<div class="recap-project-header-right">
									<label>
										<input id="recapAllProjectsToggle" type="checkbox" checked>
										All projects
									</label>
									<button id="recapRefreshProjectsBtn" type="button">Refresh Projects</button>
								</div>
							</div>
							<div id="recapProjectList" class="project-list recap-project-list"></div>
						</div>
					</div>

					<div class="recap-actions">
						<button id="recapGenerateBtn" type="button">Generate Markdown</button>
						<a id="recapDownloadLink" href="#" class="hidden" download>Download Latest Markdown</a>
						<span id="recapRunState" class="recap-run-state idle">
							<i id="recapRunStateIcon" class="bi bi-hourglass-split" aria-hidden="true"></i>
							<span id="recapRunStateText">Idle</span>
						</span>
					</div>

					<div id="recapStatus" class="logs-status">Loading projects...</div>
					<pre id="recapSummary" class="recap-report">No report generated yet.</pre>
					<div class="recap-preview-wrap">
						<h3>Markdown Preview</h3>
						<pre id="recapPreview" class="recap-report">No preview yet.</pre>
					</div>
				</div>
			</section>
		</main>
		<button id="sidebarBackdrop" class="sidebar-backdrop hidden" type="button" aria-label="Close navigation"></button>
	</div>
	<script src="theme.js?v=20260225-settings1"></script>
		<script src="recap.js?v=20260226-recap-export5"></script>
	</body>
	</html>
